**タイトル:**  
未経験から100日後にGTMのプロになる話【Day 29】  
サーバーサイドGTMの活用 〜計測の精度を次のレベルへ！〜

---

**概要（リード文）:**  
「Cookie規制の影響でデータが欠損してしまう…」  
「広告のコンバージョンが正しく計測できているか不安…」  
そんなときに救世主となるのが **サーバーサイドGTM（Server-Side GTM, SSGTM）** です。本日は、SSGTMを使って計測の精度を向上させる方法を解説します！

…と、その前に。サーバーサイドGTMって何？って話ですよね。簡単に言うと、**「計測をユーザーのブラウザ側ではなく、サーバー側で処理する仕組み」** です。

つまり、これまで「お客様の目の前でレジ打ちしてた」のを、「バックヤードで正確に計算する」ようなもの。クッキー規制や広告ブロッカーの影響を受けにくく、**「本当に必要なデータを正確に計測できる！」** というわけです。

では、早速設定していきましょう！

---

## **本文**

### **① サーバーサイドGTMとは？**

サーバーサイドGTM（SSGTM）とは、タグの処理をサーバー側で行う仕組みです。

✅ **計測データの欠損を減らす（ブラウザの制限を回避）**  
✅ **ユーザーデータのセキュリティを向上（個人情報の適切な管理）**  
✅ **サイトのパフォーマンス向上（ブラウザ側の負荷を軽減）**  

例えば、
- **従来のGTM（クライアントサイド）** → ユーザーのブラウザでタグが発火し、広告や分析ツールにデータを送信。
- **サーバーサイドGTM** → 計測データを一度自社のサーバーで処理し、必要なデータのみ各ツールへ送信。

---

### **② サーバーサイドGTMの環境をセットアップする**

まずは、SSGTMの環境を構築します。

#### **1. Google Cloudでサーバーコンテナを作成**

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス。
2. 「新しいプロジェクトを作成」→ プロジェクト名を入力。
3. 「Compute Engine」を有効化。
4. 「GTM サーバーサイドコンテナ」を作成。
5. `gtm-ss.example.com` などのサブドメインを設定。
6. **エンドポイントURLを取得！**（後でGTMで使用）

✅ **これでサーバーサイド用のGTM環境が準備完了！**

---

### **③ GTMでサーバーサイドコンテナを設定する**

#### **1. GTMの管理画面でサーバーサイドコンテナを作成**

1. [Google Tag Manager](https://tagmanager.google.com/) にアクセス。
2. 「新しいコンテナを作成」をクリック。
3. 「ターゲットプラットフォーム」を「**サーバー**」に設定。
4. 先ほど取得した「サーバーエンドポイントURL」を入力。
5. 保存。

✅ **これで、GTMにサーバーサイドコンテナが追加されました！**

---

### **④ GA4のデータ送信先をサーバーサイドに変更**

通常、GA4のデータはGoogleのサーバーに直接送信されますが、サーバーサイドGTMを使うことで **一度自社のサーバーを経由** させることができます。

#### **1. GTMのGA4タグをサーバー経由に変更**

1. GTMの「**タグ**」メニューを開く。
2. 既存の「GA4設定タグ」を開く。
3. 「**送信先**」を変更し、
   - **デフォルトURL:** `https://gtm-ss.example.com`（先ほど設定したサーバーエンドポイント）
4. 保存。

✅ **これで、GA4のデータはサーバー経由で送信されるようになります！**

---

### **⑤ Google広告のコンバージョンをサーバーサイドで処理する**

SSGTMを使えば、広告のコンバージョン計測をより正確に行えます。

#### **1. Google広告のサーバーサイドタグを作成**

1. GTMの「**タグ**」メニューを開く。
2. 「**新規**」をクリックし、タグの種類を「**Google 広告のコンバージョン トラッキング（サーバーサイド）**」に設定。
3. 「**コンバージョンID**」と「**コンバージョンラベル**」を入力。
4. 「送信先URL」を `https://gtm-ss.example.com` に設定。
5. 保存。

✅ **これで、Google広告のコンバージョンデータもサーバー経由で送信されます！**

---

### **⑥ プレビューモードで動作確認**

1. GTMの「**プレビュー**」を開く。
2. 計測対象のサイトで購入や問い合わせを実行。
3. デバッグツールの「Tags Fired（発火したタグ）」にサーバーサイドのタグがあるか確認。
4. GA4とGoogle広告の管理画面でデータが正常に記録されているか確認。

✅ **問題なくデータが送信されていることを確認したら、GTMの「送信」ボタンを押して公開！**

---

### **■ まとめ 〜サーバーサイドGTMで計測精度を向上させよう！〜**

✅ **サーバーサイドGTMを使うと、データの欠損を防ぎ、計測精度が向上する！**  
✅ **Google Cloudでサーバーコンテナをセットアップし、サーバーエンドポイントを取得！**  
✅ **GA4のデータ送信先を変更し、サーバーを経由させることでセキュリティも向上！**  
✅ **Google広告のコンバージョン計測もサーバー経由で行い、広告効果の最適化！**  

これを活用すれば、
- **「ブラウザの制限を受けない正確な計測」**
- **「サーバーを経由した安全なデータ処理」**
- **「広告とアナリティクスの連携をより強化」**

といったことが可能になります！

---

### **■ 明日の予告 〜シングルページアプリケーション（SPA）対応〜**

次回は、**「SPA（シングルページアプリケーション）の計測」** を学びます！
- **「ページビューが記録されない問題の解決」**
- **「履歴変更イベントを使ったGTMの設定」**

など、SPAのGTM計測のコツを解説します！

